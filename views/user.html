<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8' />
		<title>MapJournaling</title>
		<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
		<script src='/assets/mapbox-gl.js'></script>
		<link href='/assets/mapbox-gl.css' rel='stylesheet' />
		<style>



#map {
	height: 300px;
	width: 300px;
	border: 2px black dotted;
}

h1 {
	text-decoration: underline dotted;
}


#coord {
	width: 500px;
	height: 50px;
	border: 2px black dotted;
	font-size: 12px;
	text-align: center;
	vertical-align: top;
}

a {
}

a:hover {
	text-decoration: underline dotted;
}

		</style>
	</head>
	<body>

		<h1><span id="user-name">apt4105</span>'s journal</h1>
		<pre id='coord'></pre>
		<div id='map'></div>

		<a href="create">Create New Text Post</a>

		<ol>
			<li>
				<a href="entry1/index.html">hello</a>
			</li>
		</ol>

		<script>

function userName() {
	let path = window.location.pathname;
	if (path[path.length - 1] === '/') {
		path = path.slice(0, path.length - 1);
	}
	let idx = path.lastIndexOf('/');
	return path.slice(idx+1);
}

async function entries() {
	const req = await fetch(`/userdata/${userName()}/`)
	const res = await req.json();
	console.log(res);
}

document.querySelector("#user-name").innerText = userName();

var map = new mapboxgl.Map({
	container: 'map', // container id
	style: 'http://localhost:8080/assets/style.json', // stylesheet location
	center: [-100, 40], // starting position [lng, lat]
	zoom: 1.5 // starting zoom
});

//This allows user to move mouse to see lat/long
map.on('mousemove', function (e) {
	document.getElementById('coord').innerHTML =
		// e.point is the x, y coordinates of the mousemove event relative
		// to the top-left corner of the map
		JSON.stringify(e.point) + '<br />' +
		// e.lngLat is the longitude, latitude geographical position of the event
		JSON.stringify(e.lngLat.wrap());
});

//This allows user to click and store lat/long to DB
map.on('mousedown', function (e) {
	let x =
		JSON.stringify(e.point) + '<br />' +
		JSON.stringify(e.lngLat.wrap());
	console.log(x);

});




		</script>

	</body>
</html>
